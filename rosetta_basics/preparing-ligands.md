#How to Prepare Ligands for use in Rosetta

Author:  Sam DeLuca

Why is this process necessary?
==============================

Rosetta uses Params files to store precomputed information about the geometry and chemistry of residues and ligands. A params file is required for each residue encountered in a PDB. A set of params files for commonly seen residues and metals is included with rosetta, and can be found in rosetta\_database/chemical/residue\_type\_sets

An overview of params files
===========================

Params files store a variety of chemical and geometric information. The following lines are typically found in Ligand params files. This does not represent a complete documentation of the params fileformat. These files are read in core/chemical/residue\_io.cc

-   **NAME** The 3 letter name of the Residue. Must be unique among all residues loaded into Rosetta

-   **IO\_STRING** The 3 letter and 1 letter codes representing the residue. 3 letter code is the same as NAME, 1 letter code is Z by default.

-   **TYPE** The type of residue being represented, should be 'LIGAND' for ligands, or 'POLYMER' for protein or DNA residues

-   **AA** The amino acid type. Should be "UNK" for ligands

-   **ATOM** The PDB atom name, Rosetta AtomType, MM AtomType, and charge. an atom line looks like this:

    ```
    ATOM  C17 CH1   X   0.13
    ```

    Where C17 is the PDB atom name, CH1 is the Rosetta AtomType, X is the MM AtomType, and 0.13 is the charge. The PDB atom names must be unique within each params file.

-   **BOND** Defines a bond connection, two PDB atom names are specified

-   **CHI** Defines a rotatable chi angle. A chi angle number is specified, followed by the names of the four atoms defining the angle

-   **NBR\_ATOM** The PDB name of the "neighbor atom". In the case of ligands, this defaults to the atom that is closest to the geometric center of the ligand

-   **NBR\_RADIUS** The radius of gyration of the ligand, used to define the overall size of the ligand.

-   **ICOOR\_INTERNAL** The internal coordinates of an atom. The format looks like this:

    ```
    ICOOR_INTERNAL    O15  179.932453   59.543328    1.238233   C28   C13   N11
    ```

    And the fields are the following: Child atom, phi angle, theta angle, distance, parent atom, angle atom, torsion atom

-   **PDB\_ROTAMERS** The path to a PDB file containing ligand rotamers

Generating Ligand Confromers
============================

If you want to model ligand flexibility during protein-ligand docking, it is necessary to generate a library of ligand conformers. This library needs to be formatted as a PDB file containing the coordinates of each conformer, with the conformers seperated by "TER" lines. There are a number of ways to generate conformers, with MOE and openeye Omega being the most straight forward. Rosetta is not currently capable of generating conformers internally.

Generating Params Files one at a time using molfile\_to\_params.py
==================================================================

rosetta\_source/src/python/apps/public/molfile\_to\_params.py generates params file and a pdb file based on an input molfile. Running this script without arguments provides documentation on its usage and options. The generated PDB file has coordinates identical to the coordinates in the input molfile, and PDB atom names that match the atom names in the params file. It is critical that the atom names match between the PDB and params file. By default, the params file generated by this script has the name "LG1".

If you have a library of conformers, append a PDB\_ROTAMERS line to the end of the generated params file in the following format:

```
PDB_ROTAMERS path/to/rotamers.pdb
```

Generating Params Files in bulk using batch\_conformers.py
==========================================================

If you have a set of ligands in molfile format, you can use the script rosetta\_source/src/python/apps/public/batch\_molfile\_to\_params.py Run the script with the flag -h for a usage statement and basic instructions. It takes as input the rosetta database, a file containing a list of paths to molfiles, and the path to the molfile.params script.

This script will give each molfile a unique 3 letter code, and parses the rosetta database to ensure that no 3 letter codes are used which conflict with existing ligands in the database. Each molfile should contain confirmations for only a single ligand. If your mol file contains multiple confirmations, a PDB\_ROTAMER file will be created and referenced in the params file.

you can run it like this:

```
rosetta_source/src/python/apps/public/batch_molfile_to_params.py -d /path/to/rosetta/rosetta_database --script_path=/path/to/molfile_to_params.py list_of_molfiles.txt
```

A new directory called "params" will be created in the directory you executed the script from. This directory will have a subdirectory for each processed molfile, and this directory will contain the params file and associated ligand pdb file. In some cases molfile\_to\_params is unable to successfully create a params file. In this case, the script will continue, and the path to the failed mol file will be printed to stdout.
